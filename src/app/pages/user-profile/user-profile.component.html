
<div class="flex flex-col min-h-screen bg-surface-ground p-2 sm:p-4 lg:p-6">
	<div *ngIf="loading" class="flex justify-center items-center flex-1 min-h-[200px]">
		<p-progressSpinner styleClass="w-8 h-8" strokeWidth="4"></p-progressSpinner>
	</div>
	<div *ngIf="error && !loading" class="flex justify-center items-center flex-1 min-h-[200px]">
		<p class="text-red-600 text-center">{{ error }}</p>
	</div>

	<div *ngIf="userInfo && !loading" class="flex flex-1 flex-col w-full max-w-6xl mx-auto  bg-gradient-to-br from-primary-500 to-primary-900 text-white rounded-lg shadow-lg mt-4">
		<app-user-profile-header [userInfo]="userInfo" [loading]="loading"></app-user-profile-header>

		<div class="flex flex-col gap-4 w-full p-6">
			<div *ngIf="isOwnProfile && !editMode" class="flex justify-end mb-2">
				<button pButton type="button" icon="pi pi-pencil" label="Editar perfil" class="p-button-sm p-button-outlined p-button-info" (click)="enableEdit()"></button>
			</div>

      <form *ngIf="isOwnProfile && editMode" [formGroup]="editForm" class="rounded-lg p-4 flex flex-col gap-4">
        <div class="flex flex-col md:flex-row gap-4">
          <div class="flex-1">
            <label class="mb-1 text-sm ">Nome</label>
            <input
              pInputText
              id="firstname"
              formControlName="firstName"
              class="w-full"
              placeholder="Nome"
            />
          </div>
          <div class="flex-1">
            <label class="mb-1 text-sm ">Sobrenome</label>
            <input
              pInputText
              id="lastName"
              formControlName="lastName"
              class="w-full"
              placeholder="Sobrenome"
              title="Sobrenome"
            />
          </div>
        </div>
        <div>
          <label class="mb-1 text-sm ">Biografia</label>
          <textarea
            pInputTextarea
            id="biography"
            formControlName="biography"
            rows="3" class="w-full"
            placeholder="Biografia"
            title="Biografia">
          </textarea>
        </div>
        <div class="flex flex-col md:flex-row gap-4">
          <div class="flex-1">
            <label class="mb-1 text-sm ">Discord</label>
            <input
              pInputText
              id="discord"
              formControlName="discord"
              class="w-full"
              placeholder="Discord"
              title="Discord"
            />
          </div>
          <div class="flex-1">
            <label class="mb-1 text-sm ">LinkedIn</label>
            <input
              pInputText
              id="linkedin"
              formControlName="linkedin"
              class="w-full"
              placeholder="LinkedIn"
              title="LinkedIn"
            />
          </div>
        </div>
        <div class="flex flex-col md:flex-row gap-4">
          <div class="flex-1">
            <label class="mb-1 text-sm ">GitHub</label>
            <input
              pInputText
              id="github"
              formControlName="github"
              class="w-full"
              placeholder="GitHub"
              title="GitHub"
            />
          </div>
          <div class="flex-1">
            <label class="mb-1 text-sm ">Site pessoal</label>
            <input
              pInputText
              id="personalWebsite"
              formControlName="personalWebsite"
              class="w-full"
              placeholder="Site pessoal"
              title="Site pessoal"
            />
          </div>
        </div>
        <div>
          <label class=" mb-1">Áreas de Interesse</label>
          <p-multiSelect
            formControlName="interestRoles"
            [options]="allRoles"
            optionLabel="name"
            optionValue="id"
            display="chip"
            class="w-full"
            placeholder="Selecione as áreas de interesse"
          ></p-multiSelect>
        </div>
        <div class="flex gap-2 mt-2">
          <button pButton type="button" label="Cancelar" class="p-button-secondary" (click)="cancelEdit()" [disabled]="saveLoading"></button>
          <button pButton type="button" label="Salvar" class="p-button-success" (click)="saveEdit()" [loading]="saveLoading" [disabled]="!editForm.valid || saveLoading"></button>
        </div>
        <div *ngIf="saveError" class="text-red-400 mt-2">{{ saveError }}</div>
      </form>

      <p-card *ngIf="userInfo.interestRoles?.length && !(isOwnProfile && editMode)" styleClass="w-full text-white rounded-lg shadow-lg bg-gray-900 ">
        <h3 class="font-bold mb-2">Áreas de Interesse: </h3>
        <div class="flex flex-row flex-wrap gap-2">
          <p-tag *ngFor="let role of userInfo.interestRoles" [value]="role.name" severity="success"></p-tag>
        </div>
      </p-card>
		</div>
	</div>
</div>
